<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>To Do ãƒ«ãƒ¼ãƒ¬ãƒƒãƒˆ</title>
<script src="js/jquery-2.1.3.min.js"></script>
<link rel="stylesheet" href="css/sample.css">
</head>
<body>
<header>
<h1>To Do ãƒ«ãƒ¼ãƒ¬ãƒƒãƒˆ</h1>
</header>


<main class="relative">
    <ul class="content">
        <li class="item">
            <h2>âœï¸To Doã‚’æ›¸ãå‡ºã™</h2>
            <input type="text" id="key" style="border: none;">
            <textarea id="memo" style="border: none;"></textarea>
            <ul class="save">
                <li id="save">Save</li>
                <li id="clear">Clear</li>
            </ul>
        </li>
        <li class="item2">
            <h2 >ğŸ¯ãƒ«ãƒ¼ãƒ¬ãƒƒãƒˆã‚’å›ã™</h2>
            <button id ="start" class="start">ã‚¹ã‚¿ãƒ¼ãƒˆ</button>
            <button id ="stop" class="stop">ã‚¹ãƒˆãƒƒãƒ—</button>
        </li>
    </ul>

<div id="cards" class="cards">
<!-- ã“ã“ã«è¿½åŠ ãƒ‡ãƒ¼ã‚¿ãŒæŒ¿å…¥ã•ã‚Œã‚‹ -->
</div>
</main>
<script>

//1.Save ã‚¯ãƒªãƒƒã‚¯ã‚¤ãƒ™ãƒ³ãƒˆ
let id_array =[];
let i = 0;

$("#save").on("click",function(){
    id_array.push(i);
    i++;
    // console.log(id_array);
    let id_num = id_array.length-1;
    // console.log(id_num);
    const key = $("#key").val();
    const value = $("#memo").val();
    localStorage.setItem(key,value);
    const html = `<table class="card" id="card${id_num}"><tr class="title"><td>${key}</td></tr><tr class="detail"><td>${value}</td></tr></table>`;
    $("#cards").append(html);


});

//2.clear ã‚¯ãƒªãƒƒã‚¯ã‚¤ãƒ™ãƒ³ãƒˆ
$("#clear").on("click",function(){
    localStorage.clear();
    $("#cards").empty();
    location.reload();
});

//3.ãƒšãƒ¼ã‚¸èª­ã¿è¾¼ã¿ï¼šä¿å­˜ãƒ‡ãƒ¼ã‚¿å–å¾—è¡¨ç¤º
for(let i=0; i<localStorage.length; i++){
    const key   = localStorage.key(i);
    const value = localStorage.getItem(key);
    const html = `<table class="card" id="card${i}"><tr class="title"><td>${key}</td></tr><tr class="detail"><td>${value}</td></tr></table>`;
    $("#cards").append(html);
}


 //ãƒ«ãƒ¼ãƒ¬ãƒƒãƒˆã™ã‚‹
 
    let interval;//ã‚¤ãƒ³ã‚¿ãƒ¼ãƒãƒ«
    let first = false;//ãƒ•ãƒ©ã‚°
    let number = 0;
    let grid =0; 
    let item_length =id_array.length

 
    function start_set(){//startçŠ¶æ…‹
        document.getElementById("start").disabled = true;
        document.getElementById("stop").disabled = false;
        // document.getElementById("reset").disabled = false;
        if(first === false){
            interval = setInterval(start_go,150);
            first = true;
        }         
    }
 
    function start_go(){//startæŠ¼ä¸‹
        const aryMax= function(a,b) {return Math.max(a,b);}
        let max = id_array.reduce(aryMax);
        
        for(var k = 0; k <= max; k++){
            let div_number = document.getElementById('card'+ [k]);//è¡¨ç¤ºä¸Šã®idã®å–å¾—
            div_number.classList.remove('selecting');//.selectingã‚’æ¶ˆã™
            console.log(k);
        }
        grid = Math.floor(Math.random()*id_array.length);
        number = id_array[grid];//.selectingã‚’ã¤ã‘ã‚‹ãŸã‚ã®ãƒ©ãƒ³ãƒ€ãƒ ãªæ•°å­—ã‚’é¸æŠ
 
        div_number = document.getElementById('card'+ number);
        //console.log(div_number);
        div_number.classList.add('selecting');
    }

    function stop_set(){//stopæŠ¼ä¸‹
        document.getElementById("stop").disabled = true;
        document.getElementById("start").disabled = false;
        clearInterval(interval);
        first = false;
 
        let selecting_number = document.querySelector('.selecting');//.selectingã‚¯ãƒ©ã‚¹ã®ã¤ã„ã¦ã„ã‚‹ã‚‚ã®ã‚’å–å¾—
        //console.log(grid);  
        id_array.splice(grid,1);//é…åˆ—ã‹ã‚‰red_numberã®ã¨ã“ã‚ã‚’1ã¤å‰Šé™¤     
        //console.log(num);    
        selecting_number.classList.remove('selecting');
        selecting_number.classList.add("decide");
 
        if(id_array.length === 0){
        document.getElementById("start").disabled = true;
        }
    }
        const starter = document.getElementById("start");
        const stopper = document.getElementById("stop");
        // const resetter = document.getElementById("reset");
 
        starter.addEventListener("click",start_set,false);
        stopper.addEventListener("click",stop_set,false);
        // resetter.addEventListener("click",reset_set,false);
        document.getElementById("stop").disabled = true;
        // document.getElementById("reset").disabled = true;




</script>
<div class="footer_wrapper">
    <footer><small>G's ACADEMY</small></footer>
</div>
</body>
</html>